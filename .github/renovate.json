{
  "extends": [
    "github>SocialGouv/renovate-config",
    ":automergeAll"
  ],
  "gitlabci": {
    "fileMatch": ["\\.gitlab-ci.yml$"]
  },
  "packageRules": [
    {
      "datasources": ["docker", "github-releases", "pypi"],
      "excludePackagePatterns": [
        "^registry.gitlab.factory.social.gouv.fr/socialgouv/docker/"
      ],
      "major": {
        "semanticCommitType": "feat"
      },
      "minor": {
        "semanticCommitType": "feat"
      },
      "patch": {
        "semanticCommitType": "fix"
      },
      "separateMinorPatch": true
    },
    {
      "datasources": [
        "docker"
      ],
      "packagePatterns": [
        "^registry.gitlab.factory.social.gouv.fr/socialgouv/docker/"
      ],
      "groupName": "socialgouv/docker self dependencies",
      "minor": {
        "semanticCommitType": "fix"
      },
      "patch": {
        "semanticCommitType": "chore"
      },
      "separateMinorPatch": true
    },
    {
      "paths": ["infra-ansible-ci/requirements.txt"],
      "groupName": "infra-ansible-ci requirements",
      "extends": [
        ":automergeDisabled",
        ":semanticCommitType(feat)"
      ],
      "semanticCommitType": "feat"
    },
    {
      "paths": ["\\.gitlab-ci.yml$"],
      "semanticCommitType": "chore"
    }
  ],
  "regexManagers": [
    {
      "fileMatch": ["Dockerfile$"],
      "matchStrings": [
        "datasource=(?<datasource>.*?) depName=(?<depName>.*?)( versioning=(?<versioning>.*?))?\\sARG .*?_VERSION=(?<currentValue>.*)\\s"
      ],
      "versioningTemplate": "{{#if versioning}}{{versioning}}{{else}}semver{{/if}}"
    }
  ]
}
